import{g as ee,a as U,r as h,u as V,j as t,s as B,d as q,e as H,l as se,m as oe,b as z,T as u,t as _,h as ae,p as ie,i as te,y as Q,v as $,P as E,C as ne}from"./index-C5dV5vcY.js";import{i as le,B as J}from"./Button-Blrz6v6M.js";import{G as C}from"./Grid-CT4pOQnw.js";import{L as G,i as K,a as de}from"./Select-C6aeAHCV.js";import{D as ce}from"./Divider-BSaYpNDd.js";import{g as me,l as k}from"./listItemTextClasses-fZQGBs6a.js";import{T as j}from"./TextField-C3tuy6JB.js";import"./dividerClasses-DRX4zGyV.js";function ue(e){return ee("MuiListItem",e)}U("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const pe=U("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function he(e){return ee("MuiListItemSecondaryAction",e)}U("MuiListItemSecondaryAction",["root","disableGutters"]);const xe=e=>{const{disableGutters:r,classes:s}=e;return H({root:["root",r&&"disableGutters"]},he,s)},ye=B("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.root,s.disableGutters&&r.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),re=h.forwardRef(function(r,s){const a=V({props:r,name:"MuiListItemSecondaryAction"}),{className:o,...n}=a,d=h.useContext(G),m={...a,disableGutters:d.disableGutters},y=xe(m);return t.jsx(ye,{className:q(y.root,o),ownerState:m,ref:s,...n})});re.muiName="ListItemSecondaryAction";const ge=(e,r)=>{const{ownerState:s}=e;return[r.root,s.dense&&r.dense,s.alignItems==="flex-start"&&r.alignItemsFlexStart,s.divider&&r.divider,!s.disableGutters&&r.gutters,!s.disablePadding&&r.padding,s.hasSecondaryAction&&r.secondaryAction]},fe=e=>{const{alignItems:r,classes:s,dense:a,disableGutters:o,disablePadding:n,divider:d,hasSecondaryAction:m}=e;return H({root:["root",a&&"dense",!o&&"gutters",!n&&"padding",d&&"divider",r==="flex-start"&&"alignItemsFlexStart",m&&"secondaryAction"],container:["container"]},ue,s)},be=B("div",{name:"MuiListItem",slot:"Root",overridesResolver:ge})(oe(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:r})=>!r.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:r})=>!r.disablePadding&&r.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:r})=>!r.disablePadding&&!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>!r.disablePadding&&!!r.secondaryAction,style:{paddingRight:48}},{props:({ownerState:r})=>!!r.secondaryAction,style:{[`& > .${pe.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>r.button,style:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:r})=>r.hasSecondaryAction,style:{paddingRight:48}}]}))),ve=B("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),Y=h.forwardRef(function(r,s){const a=V({props:r,name:"MuiListItem"}),{alignItems:o="center",children:n,className:d,component:m,components:y={},componentsProps:b={},ContainerComponent:v="li",ContainerProps:{className:P,...I}={},dense:g=!1,disableGutters:S=!1,disablePadding:L=!1,divider:f=!1,secondaryAction:l,slotProps:c={},slots:i={},...T}=a,A=h.useContext(G),N=h.useMemo(()=>({dense:g||A.dense||!1,alignItems:o,disableGutters:S}),[o,A.dense,g,S]),w=h.useRef(null),x=h.Children.toArray(n),p=x.length&&le(x[x.length-1],["ListItemSecondaryAction"]),W={...a,alignItems:o,dense:N.dense,disableGutters:S,disablePadding:L,divider:f,hasSecondaryAction:p},O=fe(W),Z=se(w,s),R=i.root||y.Root||be,D=c.root||b.root||{},F={className:q(O.root,D.className,d),...T};let M=m||"li";return p?(M=!F.component&&!m?"div":M,v==="li"&&(M==="li"?M="div":F.component==="li"&&(F.component="div")),t.jsx(G.Provider,{value:N,children:t.jsxs(ve,{as:v,className:q(O.container,P),ref:Z,ownerState:W,...I,children:[t.jsx(R,{...D,...!K(R)&&{as:M,ownerState:{...W,...D.ownerState}},...F,children:x}),x.pop()]})})):t.jsx(G.Provider,{value:N,children:t.jsxs(R,{...D,as:M,ref:Z,...!K(R)&&{ownerState:{...W,...D.ownerState}},...F,children:[x,l&&t.jsx(re,{children:l})]})})}),Ce=e=>{const{classes:r,inset:s,primary:a,secondary:o,dense:n}=e;return H({root:["root",s&&"inset",n&&"dense",a&&o&&"multiline"],primary:["primary"],secondary:["secondary"]},me,r)},je=B("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[{[`& .${k.primary}`]:r.primary},{[`& .${k.secondary}`]:r.secondary},r.root,s.inset&&r.inset,s.primary&&s.secondary&&r.multiline,s.dense&&r.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${_.root}:where(& .${k.primary})`]:{display:"block"},[`.${_.root}:where(& .${k.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),X=h.forwardRef(function(r,s){const a=V({props:r,name:"MuiListItemText"}),{children:o,className:n,disableTypography:d=!1,inset:m=!1,primary:y,primaryTypographyProps:b,secondary:v,secondaryTypographyProps:P,slots:I={},slotProps:g={},...S}=a,{dense:L}=h.useContext(G);let f=y??o,l=v;const c={...a,disableTypography:d,inset:m,primary:!!f,secondary:!!l,dense:L},i=Ce(c),T={slots:I,slotProps:{primary:b,secondary:P,...g}},[A,N]=z("root",{className:q(i.root,n),elementType:je,externalForwardedProps:{...T,...S},ownerState:c,ref:s}),[w,x]=z("primary",{className:i.primary,elementType:u,externalForwardedProps:T,ownerState:c}),[p,W]=z("secondary",{className:i.secondary,elementType:u,externalForwardedProps:T,ownerState:c});return f!=null&&f.type!==u&&!d&&(f=t.jsx(w,{variant:L?"body2":"body1",component:x!=null&&x.variant?void 0:"span",...x,children:f})),l!=null&&l.type!==u&&!d&&(l=t.jsx(p,{variant:"body2",color:"textSecondary",...W,children:l})),t.jsxs(A,{...N,children:[f,l]})});function Se(e){const r={},s=o=>!(o!=null&&o.trim()),a={fullName:()=>s(e.fullName)&&"Full Name is required",email:()=>!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&"Invalid email",phone:()=>{var o;return!/^\d{10}$/.test((o=e.phone)==null?void 0:o.replace(/\D/g,""))&&"Invalid phone number"},address:()=>s(e.address)&&"Address is required",city:()=>s(e.city)&&"City is required",state:()=>s(e.state)&&"State is required",zipCode:()=>s(e.zipCode)&&"Zip Code is required",cardNumber:()=>{var o;return!/^\d{16}$/.test((o=e.cardNumber)==null?void 0:o.replace(/\s+/g,""))&&"Card number must be 16 digits"},expiryDate:()=>{if(!/^\d{2}\/\d{2}$/.test(e.expiryDate))return"Expiry date must be MM/YY";const[n,d]=e.expiryDate.split("/").map(Number),m=new Date(2e3+d,n-1);return n<1||n>12||m<=new Date?"Expiry date invalid or past":!1},cvv:()=>!/^\d{3}$/.test(e.cvv)&&"CVV must be 3 digits"};for(const o in a){const n=a[o]();n&&(r[o]=n)}return r}const Pe=()=>{const{getCartItems:e,createOrder:r,clearCart:s}=ae(),{fetchUser:a}=ie(),[o,n]=h.useState(!1),[d,m]=h.useState([]),y=te(),[b,v]=h.useState({fullName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",cardNumber:"",expiryDate:"",cvv:""}),[P,I]=h.useState({}),g=l=>c=>{v({...b,[l]:c.target.value})},S=async()=>{var l,c;try{let i=await e();(l=i==null?void 0:i.data)!=null&&l.result&&m((c=i==null?void 0:i.data)==null?void 0:c.result)}catch(i){console.log(i)}};h.useEffect(()=>{S()},[]);const L=async l=>{var c;try{let i=await s();((c=i==null?void 0:i.data)==null?void 0:c.responseCode)===200&&(await a(),y(`/thankyou/${l}`))}catch(i){console.log(i)}};return{cartItems:d,handlePlaceOrder:async()=>{var l,c,i,T,A,N;try{const w=Se(b);if(Object.keys(w).length>0){I(w);return}n(!0);let x={cartId:(c=(l=d==null?void 0:d.result)==null?void 0:l[0])==null?void 0:c._id,paymentMethod:"card",paymentGateway:"sbi",...b},p=await r(x);(i=p==null?void 0:p.data)!=null&&i.result?(n(!1),Q.success("Order succcessfully placed"),await L((A=(T=p==null?void 0:p.data)==null?void 0:T.result)==null?void 0:A.orderId)):Q.error(((N=p==null?void 0:p.data)==null?void 0:N.message)||"Something went wrong!")}catch(w){console.log(w)}finally{n(!1)}},errors:P,handleChange:g,setErrors:I,form:b,setForm:v,loading:o}};function De(){var m,y,b,v,P;const{cartItems:e,handlePlaceOrder:r,errors:s,handleChange:a,form:o,loading:n}=Pe(),d=te();return t.jsxs($,{sx:{maxWidth:1200,mx:"auto",mt:5,p:3},children:[t.jsx(u,{variant:"h4",mb:4,fontWeight:"bold",children:"Checkout"}),((m=e==null?void 0:e.result)==null?void 0:m.length)===0?t.jsxs(E,{sx:{p:5,textAlign:"center"},children:[t.jsx(u,{variant:"h6",gutterBottom:!0,children:"Your cart is currently empty."}),t.jsx(J,{variant:"contained",color:"primary",size:"large",onClick:()=>d("/"),sx:{mt:2},children:"Go to Products"})]}):t.jsxs(C,{container:!0,spacing:6,sx:{flexWrap:{xs:"wrap",md:"nowrap"},minHeight:600},children:[t.jsx(C,{item:!0,xs:12,md:6,sx:{minWidth:{md:"50%"},maxHeight:700,overflowY:"auto"},children:t.jsxs(E,{sx:{p:3},children:[t.jsx(u,{variant:"h6",mb:2,fontWeight:"bold",children:"Order Summary"}),t.jsxs(de,{children:[(y=e==null?void 0:e.result)==null?void 0:y.map(I=>I.inventories.map(({inventoryId:g,variant:S,color:L,quantity:f})=>{const l=g.price||9.99,c=l*f;return t.jsxs(Y,{divider:!0,sx:{alignItems:"flex-start"},children:[t.jsx($,{component:"img",src:g.thumbnail,alt:g.title,sx:{width:64,height:64,objectFit:"contain",borderRadius:1,mr:2,mt:.5}}),t.jsxs($,{sx:{flex:1},children:[t.jsx(u,{fontWeight:"bold",children:g.title}),t.jsxs(u,{variant:"body2",color:"text.secondary",children:["Color: ",L," | Size: ",S]}),t.jsxs(u,{variant:"body2",children:["Qty: ",f," × ₹",l.toFixed(2)]})]}),t.jsxs(u,{fontWeight:"bold",align:"right",sx:{minWidth:80},children:["₹",c.toFixed(2)]})]},g._id)})),t.jsx(ce,{sx:{my:2}}),t.jsxs(Y,{children:[t.jsx(X,{primary:"Subtotal"}),t.jsxs(u,{fontWeight:"medium",children:["₹",((b=e==null?void 0:e.subTotal)==null?void 0:b.toFixed(2))||((v=e==null?void 0:e.totalAmount)==null?void 0:v.toFixed(2))||"0.00"]})]}),t.jsxs(Y,{children:[t.jsx(X,{primary:"Total (Including Taxes)"}),t.jsxs(u,{fontWeight:"bold",color:"primary",children:["₹",((P=e==null?void 0:e.totalAmount)==null?void 0:P.toFixed(2))||"0.00"]})]})]})]})}),t.jsx(C,{item:!0,xs:12,md:6,sx:{minWidth:{md:"50%"},maxHeight:700,overflowY:"auto"},children:t.jsxs(E,{sx:{p:3},children:[t.jsx(u,{variant:"h6",mb:2,children:"Billing & Payment Information"}),t.jsx(j,{label:"Full Name",fullWidth:!0,margin:"normal",value:o.fullName,onChange:a("fullName"),error:!!s.fullName,helperText:s.fullName,required:!0}),t.jsx(j,{label:"Email",fullWidth:!0,margin:"normal",value:o.email,onChange:a("email"),error:!!s.email,helperText:s.email,required:!0}),t.jsx(j,{label:"Phone Number",fullWidth:!0,margin:"normal",value:o.phone,onChange:a("phone"),error:!!s.phone,helperText:s.phone,required:!0,inputProps:{maxLength:10}}),t.jsx(j,{label:"Address",fullWidth:!0,margin:"normal",value:o.address,onChange:a("address"),error:!!s.address,helperText:s.address,required:!0}),t.jsxs(C,{container:!0,spacing:2,children:[t.jsx(C,{item:!0,xs:6,children:t.jsx(j,{label:"City",fullWidth:!0,margin:"normal",value:o.city,onChange:a("city"),error:!!s.city,helperText:s.city,required:!0})}),t.jsx(C,{item:!0,xs:3,children:t.jsx(j,{label:"State",fullWidth:!0,margin:"normal",value:o.state,onChange:a("state"),error:!!s.state,helperText:s.state,required:!0})}),t.jsx(C,{item:!0,xs:3,children:t.jsx(j,{label:"Zip Code",fullWidth:!0,margin:"normal",value:o.zipCode,onChange:a("zipCode"),error:!!s.zipCode,helperText:s.zipCode,required:!0})})]}),t.jsx(u,{variant:"h6",mt:3,mb:1,children:"Payment Details"}),t.jsx(j,{label:"Card Number",fullWidth:!0,margin:"normal",placeholder:"1234 5678 9012 3456",value:o.cardNumber,onChange:a("cardNumber"),error:!!s.cardNumber,helperText:s.cardNumber,inputProps:{maxLength:16},required:!0}),t.jsxs(C,{container:!0,spacing:2,children:[t.jsx(C,{item:!0,xs:6,children:t.jsx(j,{label:"Expiry Date (MM/YY)",fullWidth:!0,margin:"normal",placeholder:"MM/YY",value:o.expiryDate,onChange:a("expiryDate"),error:!!s.expiryDate,helperText:s.expiryDate,required:!0})}),t.jsx(C,{item:!0,xs:6,children:t.jsx(j,{label:"CVV",fullWidth:!0,margin:"normal",placeholder:"123",value:o.cvv,onChange:a("cvv"),error:!!s.cvv,helperText:s.cvv,inputProps:{maxLength:3},required:!0})})]}),n?t.jsx($,{sx:{display:"flex",justifyContent:"center",mt:3},children:t.jsx(ne,{color:"primary"})}):t.jsx(J,{variant:"contained",color:"primary",fullWidth:!0,size:"large",sx:{mt:3},onClick:r,children:"Place Order"})]})})]})]})}export{De as default};
